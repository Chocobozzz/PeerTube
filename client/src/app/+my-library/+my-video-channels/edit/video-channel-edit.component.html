<div class="d-flex">
  <div>
    <my-lateral-menu [config]="menuConfig"></my-lateral-menu>
  </div>

  <div class="w-100 min-width-0">
    <div class="actions-container">
      <div class="actions header-block">
        <my-button class="cancel-button" icon="arrow-left" theme="secondary" i18n [ptRouterLink]="cancelLink()">Cancel</my-button>


        @if (mode === 'update') {
          <h2>
            <my-action-dropdown
              [label]="videoChannelEdit()?.channel.displayName"
              container="body"
              buttonStyled="false"
              buttonIcon="chevron-down"
              [actions]="switchChannelActions"
            >
              <ng-template #labelExtra>
                @if (user.isCollaboratingToChannels()) {
                  @if (user.isOwnerOfChannel(videoChannelEdit().apiInfo)) {
                    <my-collaborator-state class="d-inline-flex" type="owner"></my-collaborator-state>
                  } @else if (user.isEditorOfChannel(videoChannelEdit().apiInfo)) {
                    <my-collaborator-state class="d-inline-flex" type="accepted"></my-collaborator-state>
                  }
                }
              </ng-template>

              <ng-template #dropdownItemExtra let-action="action">
                @if (action.data.collaborate) {
                  @if (action.data.editor) {
                    <my-collaborator-state class="d-inline-flex ms-2" small="true" type="accepted"></my-collaborator-state>
                  } @else if (action.data.owner) {
                    <my-collaborator-state class="d-inline-flex ms-2" small="true" type="owner"></my-collaborator-state>
                  }
                }
              </ng-template>
            </my-action-dropdown>
          </h2>
        } @else {
          <h2 i18n>Create a new channel</h2>
        }

        <div class="go-public-page-save">
          @if (videoChannelEdit()?.apiInfo.id) {
            <my-button class="go-public-page" icon="external-link" theme="secondary" [href]="getChannelPublicUrl()">
              <span i18n class="go-public-page-label">Go to the public page</span>
            </my-button>
          }

          <my-button
            theme="primary" class="save-button"
            icon="circle-tick"
            [disabled]="!canUpdate()"  (click)="onSaveClick()"
            form="channel-manage-form"
            i18n
          >
            Save
          </my-button>
        </div>
      </div>

      @if (getError()) {
        <my-alert type="danger" class="d-block mt-2">
          {{ getError() }}
        </my-alert>
      } @else if (displayFormErrorsMsg && hasFormErrors()) {
        <my-alert type="warning" class="d-block mt-2">
          <div i18n>There are errors in your channel settings.</div>

          @for (errorRoot of getAllFormErrors(); track errorRoot) {
            <div class="mt-3">
              <a i18n class="alert-link" [routerLink]="errorRoot.path">{{ errorRoot.page }} page</a>

              <ul class="mb-0">
                @for (error of errorRoot.errors; track error) {
                  <li>{{ error }}</li>
                }
              </ul>
            </div>
          }
        </my-alert>
      }
    </div>

    <div class="mt-3">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
